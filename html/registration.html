<!doctype html>
<html lang="uk">

<head>
    <title>Registration</title>
    <meta charset="utf-8">

    <link href="https://fonts.googleapis.com/css?family=Poiret+One" type="text/css" rel="stylesheet">
    <link rel="stylesheet" href="../styles/main.css">
    <link rel="stylesheet" href="../styles/login.css">

    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <![endif]-->
    <script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
    <script src="../js/polyfills.js"></script>
    <script src="../js/api.js"></script>
    <script>
        $(document).ready(function() {


            $('#rg-form').submit(
                validateForm
            );
        });

        function validateForm(event) {
            var email = $('#rg-email').val(),
                login = $('#rg-login').val(),
                pass = $('#rg-passwd').val(),
                conf = $('#rg-confirm').val();
            var errorMsg = $('<div class="error"></div>'),
                firstInput = $('.rg-input').eq(0);

            $('.error').remove();

            function formErrorMsg(str) {
                errorMsg.append(str);
                firstInput.before(errorMsg);
                event.preventDefault();
                return false;
            }
            var emailValid = (function validateEmail() {
                return email.match(/^\w+[\.+]?\w+@\w+\.[a-z]{2,}$/i);
            })();
            var loginValid = (function validateLogin() {

                return login.match(/^[a-z]+.+$/i);
            })();
            var passwordValid = (function validatePassword() {
                console.log(pass);
                return pass.match(/^.{6,}$/)
            })();
            if (!loginValid) {
                formErrorMsg('<p>Логін повинен містити мінімум 2 символи і починатися літерою!</p>');
                return false;
            }
            if (!passwordValid) {
                formErrorMsg('<p>Пароль повинен містити мінімум 6 символів!</p>');
                return false;
            }
            if (pass !== conf) {
                formErrorMsg('<p>Пароль і підтвердження не співпадають!</p>');
                return false;
            }
            api.registerUser({
                login: login,
                password: pass
            }, alert, formErrorMsg);
            console.log(localStorage.userToken);
            return true;

        }
    </script>
</head>

<body>
    <div class="rg-page">
        <div class="rg-wrapper">

            <form class="rg-form" id="rg-form" method="GET" action="./user.html">
                <a href="./index.html" class="top-logo"><img src="../img/ico/svg/white-logo.svg" width="100" height="100"></a>
                <p class="rg-heading">Реєстрація</p>
                <input type="text" class="rg-input" id="rg-login" placeholder="Логін">
                <input type="email" class="rg-input" id="rg-email" placeholder="Email">
                <input type="password" class="rg-input" id="rg-passwd" placeholder="Пароль">
                <input type="password" class="rg-input" id="rg-confirm" placeholder="Підтвердити пароль">
                <input type="submit" class="rg-submit" value="Зареєструватися">

                <div class="login-info">
                    <p>Уже маєте обліковий запис?</p>
                    <a href="./login.html" class="rg-btn">Увійти</a>
                </div>
            </form>

        </div>
    </div>
</body>

</html>